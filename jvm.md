# jvm 总结

## jvm内存模型
  *  什么是jvm
   
      jvm 也就是java字节码的运行时环境，是一种运行java程序的软件应用程序，是一种java虚拟机规范，负责将java代码解释/编译执行成机器语言供操作系统运行，它的作用就是跨平台，既然是规范 ，也就有不同的虚拟机实现 比如 taobaovm，jrocket，用的最多的hotspot

  * jvm的内存模型和os的内存模型的区别？
      
      当一个java程序启动之后，就会在内存中分配一块内存空间，用于运行一个jvm进程，jvm进程包括代码段，数据区，栈空间，堆，jvm的内存就是在jvm进程的堆中分配 一块内存池

  * jvm的核心组成部分以及jvm的内存区域的划分

      总体来说jvm是由四大核心组件组成 1、类加载器子系统；2、垃圾收集器；3、执行引擎 ； 4、 jvm的内存区域
      jvm内存区域这部分在概念上分为运行时数据区
      1、方法区 （jdk7及之前永久代 jdk8之后 改用元空间）
      2、堆区
      3、虚拟机栈，本地方法栈
      4、程序计数器

  * jvm的内存模型各个区域是如何协同工作的
      
      从虚拟机栈到 方法区
        
        当执行一个方法时，会在虚拟机栈中生成一个栈帧 ，该栈帧包括局部变量表，动态链接，操作栈，方法的返回地址；动态连接保存的就是该栈帧所属的方法对应c++对象的在内存中的真实地址，因为我们的类经由编译器编译成字节码，之后被类加载器加载进jvm的内存中，会在方法区生成一个metaklass类，而在这个内部会有一个方法对象集合，动态连接指向的就是这部分地址
    
    从虚拟机栈到 堆区
       
        当在方法内部创建一个对象，几乎大部分对象都是在堆区分配内存的所有就有一个操作数栈指向对内存的地址指针

    方法区到堆区
    
        Jdk7之后就不存在方法区对堆区的引用，jdk7之前静态属性是存放在方法区(永久代中） 所以需要找到静态属性在堆内存中的真实地址

    堆区到 方法区


        对象的对象头 有一部分叫做类型指针，指向的是对应方法区该对象所属的类
        
 *  jvm的堆内存和内存碎片的概念

        堆内存其实就是从jvm内存划分处来的一小块内存池，堆内存分为两部分 为新生代和老年代 1：2 新生代分为eden区 和 s0区和s1区 为8：1：1 
        内存碎片就是当对象被垃圾收集器回收之后，原先占据的内存变得不规整，变成了一块一块的，就形成了内存碎片 ，内存碎片会影响新对象大小的分配，所以才会有了垃圾收集器的整理压缩算法

* jvm内部对象分配内存的策略
        
        1、 空闲列表
        2、 指针碰撞
            

        3  TLAB线程私有缓冲区
             因为堆区是线程共享的，假设现在有100个线程需要创建100个对象，需要加锁，这样就影响了创建对象的性能，所有jvm通过给每个线程设置私有的内存区域，避免了锁带来的性能的开销提升分配内存的效率，缺点就是私有内存会用完，           


       
       